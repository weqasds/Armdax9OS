# 环境变量与变量概述
CMake 中的 `cmake-variables`（CMake 变量）和 `cmake-env-variables`（环境变量）是两种不同的变量类型，其核心区别体现在 **定义方式、作用域、生命周期** 和 **用途** 上。以下是详细对比：

---

## **1. 定义方式与作用域**
| **特性**              | **CMake 变量**                     | **环境变量**                       |
|-----------------------|-----------------------------------|-----------------------------------|
| **定义方式**          | 通过 `set()` 或 CMake 内置预定义  | 通过 `set(ENV{<var>} <value>)` 或系统环境变量设置 |
| **作用域**            | 遵循 CMake 变量作用域（目录、函数、全局） | 全局作用域，仅在当前 CMake 进程中有效 |
| **持久性**            | 可缓存（通过 `CACHE` 关键字）     | 不缓存，退出 CMake 后失效     |
| **访问语法**          | `${VAR_NAME}`                     | `$ENV{VAR_NAME}`                 |

---

## **2. 生命周期与用途**
### **CMake 变量**  
• **用途**：  
  • **控制构建过程**：如 `CMAKE_BUILD_TYPE`（构建类型）、`CMAKE_CXX_STANDARD`（C++ 标准）。  
  • **路径管理**：如 `CMAKE_INSTALL_PREFIX`（安装路径）、`PROJECT_SOURCE_DIR`（项目源码目录）。  
  • **工具链配置**：如 `CMAKE_C_COMPILER`（指定 C 编译器）。  
• **生命周期**：  
  • 普通变量在退出作用域后失效，缓存变量（`CACHE`）在多次构建中保留。

### **环境变量**  
• **用途**：  
  • **系统级配置**：如 `PATH`（系统路径）、`JAVA_HOME`（JDK 路径）。  
  • **临时传递参数**：例如在命令行中设置 `CMAKE_PREFIX_PATH=/opt/libs cmake ..`。  
  • **跨进程通信**：在 CMake 脚本中读取或修改系统环境变量。  
• **生命周期**：  
  • 仅在当前 CMake 进程有效，不影响系统环境或其他进程。

---

## **3. 预定义变量对比**
| **类型**       | **示例**                                | **说明**                                                                 |
|---------------|---------------------------------------|-------------------------------------------------------------------------|
| **CMake 变量** | `CMAKE_VERSION`（CMake 版本） | 由 CMake 自动定义，用于提供构建系统信息或控制构建行为。                            |
| **环境变量**   | `ENV{PATH}`（系统路径）       | 由操作系统或用户定义，CMake 通过 `$ENV{}` 读取，常用于依赖库查找或外部工具调用。 |

---

## **4. 典型使用场景**
### **CMake 变量**  
• **配置构建选项**：  
  ```cmake
  set(CMAKE_BUILD_TYPE Release)  # 设置构建类型为 Release
  ```
• **路径管理**：  
  ```cmake
  set(CMAKE_INSTALL_PREFIX "/usr/local")  # 定义安装路径
  ```
• **条件编译**：  
  ```cmake
  if(CMAKE_SYSTEM_NAME STREQUAL "Linux")
    add_definitions(-DLINUX)
  endif()
  ```

### **环境变量**  
• **读取系统配置**：  
  ```cmake
  message(STATUS "Home目录: $ENV{HOME}")  # 输出用户家目录
  ```
• **临时覆盖路径**：  
  ```bash
  # 命令行中传递环境变量
  export CMAKE_PREFIX_PATH=/opt/openssl && cmake ..
  ```
• **设置编译器参数**：  
  ```cmake
  set(ENV{CXXFLAGS} "-O2 -Wall")  # 影响子进程的编译器参数
  ```

---

## **5. 注意事项**  
1. **变量优先级**：  
   • CMake 变量优先级高于环境变量。例如，若同时设置 `CMAKE_PREFIX_PATH`（CMake 变量）和 `ENV{CMAKE_PREFIX_PATH}`（环境变量），CMake 变量会覆盖环境变量。  
2. **作用域隔离**：  
   • CMake 变量支持目录/函数级作用域隔离（如 `PARENT_SCOPE`），而环境变量全局可见。  
3. **跨平台兼容性**：  
   • 环境变量的路径分隔符需注意平台差异（如 `:` 在 Linux，`;` 在 Windows）。

---

## **总结**  
• **CMake 变量**是构建系统的核心配置工具，用于定义构建规则、路径和编译选项。  
• **环境变量**用于与外部系统交互，传递临时参数或读取系统配置。  
• 实际项目中，通常结合两者：用 CMake 变量管理构建逻辑，用环境变量处理外部依赖或平台差异。


# 环境变量附录
# 变量附录